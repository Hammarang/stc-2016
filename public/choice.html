<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="css/main.css" media="screen" title="no title">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Lobster|Ranga|Roboto|Tillana" rel="stylesheet">
  <script src="https://use.fontawesome.com/e85b70dd82.js"></script>
  <title>Spotify Tech Challenge - 2016 Demo</title>
</head>
<script>
  window.onload = function() {
      let gotoPage = window.location.origin + "/user_info";

      fetch(gotoPage)
        .then(
          function(response) {
            if (response.status !== 200) {
              console.log('Looks like there was a problem. Status Code: ' +
                response.status);
              return;
            }

            // Examine the text in the response
            response.json().then(function(data) {
              console.log(data);
              document.getElementById("profile_pic").src = data.user_image;
              document.getElementById("user_name").innerHTML = data.user_name;
            });
          }
        )
        .catch(function(err) {
          console.log('Fetch Error :-S', err);
        });

    document.getElementById("upload_choice").addEventListener("click", function() {
      let fileUploader = document.getElementById('upload_file');
      fileUploader.onchange = function(event) {
        let fileList = fileUploader.files;
        if (FileReader && fileList && fileList.length) {
          var fr = new FileReader();
          fr.onload = function () {
            var image = fr.result;
            if (image !== undefined) {
              localStorage.setItem("imgData", getBase64Image(image));
              document.location = window.location.origin + "/app.html";
            }
          }
          fr.readAsDataURL(fileList[0]);
        }
      }
      fileUploader.click();
    });
  }
</script>
<body>
	<div id="header">
		<div>
      <img id="profile_pic" />
      <p id="user_name" />
		</div>
		<div id="sign_out_btn">
		</div>
	</div>

	  <div id="title">
    </div>

    <div id="img_choice_container">
   		<div class="img_choice">
   		</div>
      <a href="take_picture.html">
        <div id="instagram_choice">
          <i class="fa fa-instagram" aria-hidden="true"></i>
        </div>
      </a>
      <div id="upload_choice">
        <i class="fa fa-upload" aria-hidden="true"></i>
        <input id="upload_file" type="file" name="upload_file">
      </div>

   		<div id="choice_desc">
        <!-- <p>Upload an image from your device, or use photos from your instagram account!</p> -->
   		</div>
   		<div id="info">
   		</div>
    </div>

</body>
<script src="lib/color-thief.min.js" charset="utf-8"></script>
<script src="js/main.js" charset="utf-8"></script>
</html>
